<div class="background">

  <div class="container">
    <h2>{{ "allListings" | translate }}</h2>
  </div>
  <div class="container results-container">
    <div class="simple-search-container">
      <input type="text" placeholder="Full Text Search" name="title" [(ngModel)]="fullTextSearchPattern" (ngModelChange)="performSearch()">

     <!-- <button type="submit" class="submit-button" (click)="performSearch()">Search</button> -->
      <button type="button" class="small-button" (click)="clearSearch()">Clear</button>

      <div class="advanced-search-toggle">
        <label class="toggle-label">Advanced</label>
        <label class="toggle-container">
          <input type="checkbox" [(ngModel)]="isAdvancedSearch">
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>

    <div *ngIf="isAdvancedSearch"  class="simple-search-container">
      <div class="input-flex">
        <label>Start Date:</label>
        <input type="date" placeholder="Start Date" name="startDate" [(ngModel)]="searchStartDate" class="date-input" (ngModelChange)="performSearch()">
        <label>End Date:</label>
        <input type="date" placeholder="End Date" name="endDate" [(ngModel)]="searchEndDate" class="date-input" (ngModelChange)="performSearch()">
        <label>Qualification:</label>
        <select name="qualificationType" [(ngModel)]="searchQualificationType" (ngModelChange)="performSearch()">
          <option *ngFor="let type of qualificationTypes" [ngValue]="type === 'Any' ? null : type">{{ type }}</option>
        </select>
      </div>
    </div>

    <!-- listings -->
    <div class="row listing equal-height" *ngFor="let listing of listings" (click)="goToListing(listing.id)">
      <div class="col col-md-1 d-flex align-items-center justify-content-center">
        <i class="bi bi-star"></i>
        <mat-icon>star_border</mat-icon>
      </div>
      <div class="col col-md-9 d-flex align-items-center justify-content-center">
        <h3 class="my-auto text-center">{{listing.title}}</h3>
      </div>
      <div class="col col-md-2 d-flex align-items-center justify-content-center">
        <div class="row-fluid">
          <div><h4 class="my-auto text-center">{{ listing.requirement.toString() | translate }}</h4></div>
          <div><h5 class="my-auto text-center">{{ listing.createdAt | date }}</h5></div>
        </div>
      </div>
    </div>
    <!-- Pagination Controls -->
    <div class="pagination-container d-flex justify-content-center">

      <button (click)="loadPage(1)"
              [disabled]="currentPage === (1)">First</button>

      <!-- Previous and Next Buttons -->
      <button (click)="loadPage(currentPage - 1)"
              [disabled]="currentPage === 1">Previous</button>
      <span *ngIf="totalPages > 0; else noResultsSpan" class="pagination-text">Page {{ currentPage }} of {{ totalPages }}</span>
      <ng-template #noResultsSpan><span class="pagination-text">No Results</span></ng-template>
      <button (click)="loadPage(currentPage + 1)"
              [disabled]="currentPage === totalPages || totalPages === 0">Next</button>

      <button (click)="loadPage(this.totalPages - 1)"
              [disabled]="currentPage === (this.totalPages-1) || totalPages === 0">Last</button>
    </div>

  </div>

</div>
